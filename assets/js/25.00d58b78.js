(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{178:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),a("ul",[a("li",[t._v("所有函数都是在后端执行")]),a("li",[t._v("所有变量都是可选的")]),a("li",[t._v("由于web框架使用的"),a("a",{attrs:{href:"https://koa.bootcss.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Koa"),a("OutboundLink")],1),t._v("，下面的ctx就是Koa的ctx")]),a("li",[t._v("增加通用元配置文件同名文件在目录：src/server/meta 下")])]),t._m(1),a("p",[t._v("query格式：{key1:value1,key2:value2}")]),a("p",[t._v("使用举例")]),a("p",[t._v("例子一：需要在所有新增的记录里增加一个人读字段：addTime，记录增加时间")]),t._m(2),a("p",[t._v("例子二：使用时间戳作为_id")]),t._m(3),a("p",[t._v("完整文件:")]),a("p",[t._v("项目目录/src/server/company/Department.js")]),t._m(4)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"后端元配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端元配置文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 后端元配置文件")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("变量名")]),a("th",[t._v("hook说明")]),a("th",[t._v("类型")]),a("th",[t._v("返回")])])]),a("tbody",[a("tr",[a("td",[t._v("beforeFilter")]),a("td",[t._v("生成查询条件前")]),a("td",[t._v("Function(query,ctx)")]),a("td",[t._v("query")])]),a("tr",[a("td",[t._v("beforeUpdate")]),a("td",[t._v("编辑保存前")]),a("td",[t._v("Function(doc,ctx,metaData,isUpdateFile)")]),a("td",[t._v("doc")])]),a("tr",[a("td",[t._v("beforeAdd")]),a("td",[t._v("新增保存前")]),a("td",[t._v("Function(doc,ctx)")]),a("td",[t._v("doc")])]),a("tr",[a("td",[t._v("beforeRemove")]),a("td",[t._v("删除保存前")]),a("td",[t._v("Function(query,ctx,metaData)")]),a("td",[t._v("query")])]),a("tr",[a("td",[t._v("beforeBatchRemove")]),a("td",[t._v("批量删除保存前")]),a("td",[t._v("Function(query,ctx,metaData)")]),a("td",[t._v("query")])]),a("tr",[a("td",[t._v("beforeList")]),a("td",[t._v("不分页、提交查询前")]),a("td",[t._v("Function(query,ctx)")]),a("td",[t._v("-")])]),a("tr",[a("td",[t._v("afterList")]),a("td",[t._v("不分页、查询到数据后和返回查询数据前")]),a("td",[t._v("Function(records,query,ctx)")]),a("td",[t._v("records")])]),a("tr",[a("td",[t._v("beforeListPage")]),a("td",[t._v("分页、提交查询前")]),a("td",[t._v("Function(query,ctx)")]),a("td",[t._v("-")])]),a("tr",[a("td",[t._v("afterListPage")]),a("td",[t._v("分页、查询到数据后和返回查询数据前")]),a("td",[t._v("Function(records,query,ctx)")]),a("td",[t._v("records")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("beforeAdd"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("doc"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  doc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addTime"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("utility"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("YYYYMMDDHHmmss")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token comment"}},[t._v("// '2018-07-17 14:43:02'")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" doc\n "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("beforeAdd"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("doc"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  doc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getTime")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" doc\n "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" utility "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'utility'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token function"}},[t._v("beforeAdd")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("doc"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ctx"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tdoc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addTime"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("utility"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("YYYYMMDDHHmmss")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token comment"}},[t._v("// '2018-07-17 14:43:02'")]),t._v("\n\t\tdoc"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getTime")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" doc \n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])])}],!1,null,null,null);s.default=e.exports}}]);